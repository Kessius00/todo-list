(()=>{"use strict";function t(t){for(;t.children.length>0;)t.removeChild(t.children[0])}function e(t){const e=t.priority,n=t.dueDate,c=t.title,o=document.createElement("li");o.classList.add("task"),o.id="task",o.value=e;const s=document.createElement("div");s.classList.add("task-start");const r=document.createElement("div");r.classList.add("close-task"),s.appendChild(r);const d=document.createElement("div");d.classList.add("task-title");const i=document.createElement("button");i.classList.add("task-title-btn"),i.textContent=c;const a=document.createElement("input");a.type="text",a.classList.add("task-title-input","hidden");const l=document.createElement("button");l.textContent="accept",l.classList.add("accept-title-btn","hidden"),d.appendChild(i),d.appendChild(a),d.appendChild(l),s.appendChild(d);const u=document.createElement("button");u.textContent="accept",u.classList.add("accept-date-btn","hidden");const p=document.createElement("div");p.classList.add("task-date");const m=document.createElement("button");m.classList.add("task-date-btn"),m.textContent=n;const f=document.createElement("input");return f.type="date",f.classList.add("task-date-input","hidden"),p.appendChild(u),p.appendChild(m),p.appendChild(f),o.appendChild(s),o.appendChild(p),o}class n{constructor(t,e,n){this.title=t,this.dueDate=e,this.priority=n}}class c{constructor(t,e,n){this.projectName=t,this.projectArray=e,this.projectActive=n}sortFunction(t,e){return t.priority>e.priority?1:t.priority<e.priority?-1:0}sortProjectList(){this.projectArray.sort(this.sortFunction)}appendProjectList(t){this.projectArray.push(t),this.sortProjectList()}}function o(t){localStorage.clear(),function(t){const e=JSON.stringify(t);localStorage.setItem("projects",e)}(t),console.log("new storage projects list: ",function(){const t=localStorage.getItem("projects");if(null!==t)return JSON.parse(t);console.log("No list found of name projects")}())}document.querySelector("body");const s=document.querySelector("ul#todo-list"),r=document.querySelector(".task-form-submit"),d=document.querySelector("#projects");let i=document.querySelector(".active"),a=document.querySelectorAll("#project");const l=document.querySelector(".popUpProject"),u=document.querySelector(".EnterProjectBtn"),p=document.querySelector(".CancelProjectBtn");let m=[new c("Home",[],!0),new c("Work",[],!1)];v();let f=y();console.log("current project: ",f);const h=document.querySelector("button.addNewProject");function v(){t(d);for(let t of m){const e=document.createElement("li");e.classList.add("project"),e.setAttribute("id","project"),e.textContent=t.projectName,t.projectActive&&e.classList.add("active"),d.appendChild(e)}a=document.querySelectorAll("#project"),g()}function L(t){let e=[];for(let t of m)e.push(t.projectName);return!e.includes(t.projectName)}function j(){const n=y().projectArray;t(s);for(let t of n)s.appendChild(e(t))}function y(){for(let t of m)if(t.projectActive)return t}function E(t,e=m){for(let n of e)if(t.projectName==n.projectName){let c=e.indexOf(n);e[c]=t,f=t}o(e)}function k(){for(let t of m)t.projectActive=!1}function C(t,e,n,c){const s=e.value;t.textContent=s,t.classList.remove("hidden"),n.classList.add("hidden"),e.classList.add("hidden");let r=f;for(let t of r.projectArray)if(t.title==c){const e=r.projectArray.indexOf(t);t.title=s,r.projectArray[e]=t}E(r),o(m)}function A(){const t=document.querySelectorAll(".task-title-btn"),e=document.querySelectorAll(".task-date-btn");t.forEach((t=>{t.addEventListener("click",(()=>{const e=t.textContent,n=t.parentElement.children[1],c=t.parentElement.children[2];t.classList.add("hidden"),n.value=e,n.classList.remove("hidden"),n.focus(),c.classList.remove("hidden"),c.addEventListener("click",(o=>{C(t,n,c,e)})),n.addEventListener("focusout",(o=>{C(t,n,c,e)})),n.addEventListener("keydown",(o=>{"Enter"===o.key&&C(t,n,c,e)}))}))})),e.forEach((t=>{t.addEventListener("click",(()=>{const e=t;e.classList.add("hidden");const n=t.parentElement.children[0],c=t.parentElement.children[2];n.classList.remove("hidden");const o=e.textContent;c.value=o,c.classList.remove("hidden"),c.focus(),c.addEventListener("focusout",(t=>{S(e,n,c,f,o)})),c.addEventListener("keydown",(t=>{"Enter"===t.key&&S(e,n,c,f,o)}))}))}))}function S(t,e,n,c,o){const s=n.value;t.textContent=s,e.classList.add("hidden"),n.classList.add("hidden"),t.classList.remove("hidden");let r=c;for(let t of r.projectArray)if(t.dueDate==o){const e=r.projectArray.indexOf(t);t.dueDate=s,r.projectArray[e]=t}E(r)}function g(){a.forEach((t=>{t.addEventListener("click",(t=>{let e=t.target;if(!e.classList.contains("active")){for(let t of a)t.classList.contains("active")&&(k(),t.classList.remove("active"));const t=e.textContent;for(let e of m)e.projectName==t&&(e.projectActive=!0,E(e));e.classList.add("active"),i=e,j(),A(),console.log("Change of project: ",f)}}))}))}h.addEventListener("click",(()=>{l.classList.remove("hidden"),h.classList.add("hidden")})),u.addEventListener("click",(e=>{e.preventDefault();const n=document.getElementById("titleProject").value;if(console.log(n),""==n)return void alert("A title of the project must be written!");const s=new c(n,[],!1);var r;L(s)?(L(r=s)&&(m.push(r),t(d),v()),v(),o(m),l.classList.add("hidden"),h.classList.remove("hidden")):alert("Title already taken")})),p.addEventListener("click",(t=>{t.preventDefault(),l.classList.add("hidden"),document.getElementById("projectForm").reset(),h.classList.remove("hidden")})),g(),r.addEventListener("click",(t=>{t.preventDefault();const e=document.getElementById("titleInputField").value,c=document.getElementById("due-date").value,s=document.querySelector("input[type='radio']:checked").value;if(""==e)return void alert("A title of the task must be written!");const r=new n(e,c,s),d=y();d.appendProjectList(r),E(d),j(),o(m),closeForm(),A()}))})();